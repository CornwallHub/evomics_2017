- name: Installing motd Prerequisites
  apt: name={{item}} state=present
  with_items:
    - lsb-release
    - figlet
    - update-motd

- name: Removing Old motd Directory
  file: path=/etc/update-motd.d/ state=absent
  become: yes

- name: Create new motd Directory
  file: path=/etc/update-motd.d/ state=directory
  become: yes

- name: Creating Header
  blockinfile:
    dest: /etc/update-motd.d/00-header
    create: yes
    marker: ""
    mode: 0755
    content: |
      #!/bin/bash
      [ -r /etc/lsb-release ] && . /etc/lsb-release
      if [ -z "$DISTRIB_DESCRIPTION" ] && [ -x /usr/bin/lsb_release ]; then
        # Fall back to using the very slow lsb_release utility
        DISTRIB_DESCRIPTION=$(lsb_release -s -d)
      fi
      figlet $(hostname) | lolcat -f
      printf "\n"
      printf "Welcome to %s (%s).\n" "$DISTRIB_DESCRIPTION" "$(uname -r)"
      printf "\n"

- name: Remove MOTD File
  file: path=/etc/motd.dynamic state=absent
  become: yes
